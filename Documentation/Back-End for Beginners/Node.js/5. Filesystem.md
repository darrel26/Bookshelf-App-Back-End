Seluruh data di komputer dikelola dan diakses melalui *filesystem*. Ketika menjalankan kode JavaScript pada browser, sangat penting untuk melimitasi JavaScript dalam mengakses *filesystem*. Teknik ini dinamakan dengan *sandboxing*, yang berguna untuk melindungi kita dari program jahat serta tindakan pencurian yang dapat merampas privasi penggunannya.

Node.js menyediakan core modules **fs** yang dapat mempermudah kita dalam mengakses *filesystem*. Setiap method yang ada di module **fs** tersedia dalam dua versi, yakni versi *asynchronous* yang merupaka *default*-nya, dan versi *synchronous*.

Untuk mengakses berkas pada komputer kita dapat menggunakan method **fs.readFile()**. Method ini menerima tiga argument, yaitu **lokasi berkas**, **encoding**, dan **callback function** yang akan terpanggil bila berkas berhasil/gagal diakses.

```javascript
const fs = require('fs');

const fileReadCallback = (error, data) => {
	if(error) {
        console.log('Gagal membaca berkas');
		return;
	}
	console.log(data);
};

fs.readFile('todo.txt', 'UTF-8', fileReadCallback);
```

untuk menggunakan method secara *synchronous* bisa dengan menggunakan **fs.readFileSync()**.

```javascript
const fs = require('fs');

const data = fs.readFileSync('todo.txt', 'UTF-8');
console.log(data);
```

## Readable Stream

Melalui fungsi **readFile** baik *asynchronous* atau *synchronous*, bekerja dengan membaca berkas hingga selesai sebelum mengembalikan data. Itu berarti bila berkas yang digunakan merupakan berkas yang besar, akan membutuhkan waktu yang lama dan memori yang besar unutk mendapatkan hasilnya. Untuk mengatasi masalah tersebut solusinya adalah dengan menggunakan teknik stream, yaitu dengan tidak membaca berkas secara sekaligus, tapi dengan mengirimnya bagian per-bagian.

Teknik stream merupakan salah satu konsep fundamental yang mendukung aplikasi Node.js, dimana teknik ini dapat menangani kasus baca tulis berkas, komunikasi jaringan, atau beban kerja apapun agar berjalan lebih efisien.

Teknik ini dapat diterapkan dengan menggunakan method **createReadStream()** dari core module **fs**

```javascript
const fs = require('fs');

const readableStream = fs.createReadStream('./article.txt', {
	highWaterMark: 10
});

readableStream.on('readable', () => {
	try {
		process.stdout.write(`[${readableStream.read()}]`);
	} catch(error) {
		// catch the error when the chunk cannot be read.
	}
});

readableStream.on('end', () => {
	console.log('Done!');
});
```

Fungsi **createReadStream()** menerima dua argumen yaitu, lokasi berkas yang hendak dibaca, dan yang kedua adalah objek konfigurasi. Di dalam objek konfigurasi kita dapat menetapkan ukuran buffer melalui properti highWaterMark yang memiliki nilai *default* 16384 bytes ( 16kb ). Jika hanya menggunakan berkas teks yang ukurannya sangat kecil, ukuran buff bisa diperkecil dengan menurunkan nilai pada properti highWaterMark.

>   **Buffer** di dalam stream adalah memori sementara yang digunakan oleh stream dalam menyimpan data hingga data tersebut dikonsumsi.

**createReadStream()** mengembalikan **EventEmitter**, di mana kita dapat menetapkan fungsi listener setiap kali event readable dibangkitkan. Event readable akan dibangkitkan ketika buffer sudah memiliki ukuran sesuai dengan nilai yang ditetapkan pada properti highWaterMark, dalam arti buffer sudah siap dibaca. Kemudian event end akan dibangkitkan setelah proses stream selesai.

 -- ***article.txt*
 
```
Stream di Node.js

Teknik stream merupakan salah satu konsep fundamental yang mendukung aplikasi Node.js bekerja. Teknik ini dapat menangani kasus baca tulis berkas, komunikasi jaringan, atau beban kerja apapun agar dapat berjalan dengan lebih efisien.
```

-- ***Output***

```
[Stream di ][Node.js

][Teknik str][eam merupa][kan salah ][satu konse][p fundamen][tal yang m][endukung a][plikasi No][deJS beker][ja. Teknik][ ini dapat][ menangani][ kasus bac][a tulis be][rkas, komu][nikasi jar][ingan, ata][u beban ke][rja apapun][ agar dapa][t berjalan][ dengan le][bih efisie][n.][null]Done
```

>   Pada kode diatas properti highWaterMark memiliki value 10 ( bytes ), Itu artinya berkas akan dibaca setiap 10 karakter (1 karakter = 1 bytes)

## Writeable Stream

Untuk membuat writable stream dalam menulis berkas gunakanlah method **createWriteStream()**, dari core module **fs**.

```javascript
const fs = require('fs');

const writableStream = fs.createWriteStream('output.txt');
```

Fungsi ini menerima satu argumen yaitu, alamat berkas untuk menyimpan hasil data yang dituliskan. Berkas output akan dibuat secara otomatis jika tidak ada, ***namun bila berkas tersebut sudah ada, maka data sebelumnya akan tertimpa!***

Lalu untuk menuliskan data pada writable stream, gunakan method **write()**.

```javascript
const fs = require('fs');

const writableStream = fs.createWriteStream('output.txt');

writableStream.write('Ini merupakan teks baris pertama!\n');
writableStream.write('Ini merupakan teks baris kedua!\n');
writableStream.end();
```

Method **end()** digunakan untuk menandakan akhir dari writeable stream sekaligus bisa digunakan sebagai penulisan writeable terakhir.

```javascript
const fs = require('fs');

const writableStream = fs.createWriteStream('output.txt');

writableStream.write('Ini merupakan teks baris pertama!\n');
writableStream.write('Ini merupakan teks baris kedua!\n');
writableStream.end('Akhir dari writable stream!');
```

-- **Output.txt**

```
Ini merupakan teks baris pertama!
Ini merupakan teks baris kedua!
Akhir dari writable stream!
```

